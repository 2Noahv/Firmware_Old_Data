

package ch03;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.table.DefaultTableModel;


public class DbTest extends JFrame {
	static ResultSet rs; 	// 실행결과 객체 선언
	static Statement pstmt;	// SQL명령 전달 위한 객체 선언
	
	//Main Table
	DefaultTableModel dtm;
	JTable table;
	JScrollPane Scroll;
	JLabel label;
	JPanel panel1, panel2;
	JButton but,but1,but2,but3;
	
	JLabel la_name, la_age, la_job;
	JTextField tf_name, tf_phone, tf_addr;
	JButton bt_input, bt_cancel;
	
	
	DbTest () throws SQLException {
	setTitle("테이블");
	//테이블 영역에 들어갈 데이터 2차원 배열로 선언 
	String[] colName = {"이름","등급","나이","직업"};
	Object[][] data = {};
	
	//JPanel 만들어 추가
	panel1 = new JPanel();
	label = new JLabel("안녕 테이블~ ^^*");
	panel1.add(label);
	add("North",panel1);
	
	// 입력폼
	dtm = new DefaultTableModel(data,colName);
	table = new JTable(dtm);
	Scroll = new JScrollPane(table);	//table 객체에 Title 표시 , 테이블 유효 높이 만큼만 표시
	add("East",Scroll);
	
//	JTable table = new JTable(dtm);
//	JScrollPane spanel = new JScrollPane(table);	//table 객체에 Title 표시 , 테이블 유효 높이 만큼만 표시
////	table.setAutoCreateRowSorter(true);

	//JPanle 만들어 추가
	
	this.add(Scroll);
	
	this.setVisible(true);
	this.setSize(500, 500);
	this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
	
	
	
	DataB.open();
	select();
	DataB.close();
	}

	public static void main(String[] args) throws SQLException {
		// TODO Auto-generated method stub
		new DbTest();
	}
	public void select() {
		int i =0;
		String sql = "select * from costomer ";	//SQL 명령 (테이블의 모듈 필드)
		try {
			pstmt = DataB.conn.prepareStatement(sql);
			rs = pstmt.executeQuery(sql);
			
			rs.next();
			do {
				String name = rs.getString("cname");
				String grade = rs.getString("grade");
				String age = rs.getString("age");
				String job = rs.getString("job");
				Object[] rowData = {name, grade, age,job};
				dtm.addRow(rowData);	//
				
			} while (rs.next());
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}
	
	
	void initTF() {
		tf_name.
	}
	
	
	public int regist() {
		
		int result = 0;
		String query = "INSERT INTO friend(name, phone, addr) VALUES(?,?,?)";
		
		try {
			pstmt = DataB.conn.prepareStatement(query);
			pstmt.setString(1, );
			result = pstmt.executeUpdate(query);
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return result;
	}
	
	
}


// DB에 넣어야 할 자료
package ch02;

import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableModel;

public class JTabelTest extends JFrame {
		
		DefaultTableModel dtm;
		JTable table;
		JScrollPane Scroll;
		JLabel label;
		JPanel panel1, panel2;
		JButton but,but1,but2,but3;
		
		
	public JTabelTest() {
		
		panel1 = new JPanel();
		label = new JLabel("안녕 테이블~ ^^*");
		panel1.add(label);
		add(panel1,"North");
		
		String[] columnNames = {"이름", "나이", "직업"};
		Object[][] rowData = { {"홍길동", 13, "학생"},  {"김유신", 15, "화랑"}, {"김덕만", 16, "공주"}};
		
		dtm = new DefaultTableModel(rowData,columnNames);
		table = new JTable(dtm);
		Scroll = new JScrollPane(table);	//table 객체에 Title 표시 , 테이블 유효 높이 만큼만 표시
		add("Center",Scroll);
		
		
		panel2 = new JPanel();
		but = new JButton("추가");
		but1 = new JButton("삭제");
		but2 = new JButton("수정");
		but3 = new JButton("종료");
		panel2.add(but);
		panel2.add(but1);
		panel2.add(but2);
		panel2.add(but3);
		add(panel2,"South");
		
		MyMouseListener listener = new MyMouseListener();
		table.addMouseListener(listener);
		
		
		this.setTitle("JTable 테스트");
		this.setVisible(true);
		this.setSize(500, 500);
		this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
	}
	
		
		 class MyMouseListener implements MouseListener {

			@Override
			public void mouseClicked(MouseEvent e) {
				// TODO Auto-generated method stub
				int srow = table.getSelectedRow(); // 선택된 행 인덱스
				
				Object name = table.getValueAt(srow, 0);
				Object age = table.getValueAt(srow, 1);
				Object job = table.getValueAt(srow, 2);
				
				label.setText("이름:" + name + ", 나이:"+  age + ", 직업:" + job);
			}

			@Override
			public void mousePressed(MouseEvent e) {
				// TODO Auto-generated method stub
				
			}

			@Override
			public void mouseReleased(MouseEvent e) {
				// TODO Auto-generated method stub
				
			}

			@Override
			public void mouseEntered(MouseEvent e) {
				// TODO Auto-generated method stub
			
			}

			@Override
			public void mouseExited(MouseEvent e) {
				// TODO Auto-generated method stub
				
			}
			 
		 }
	
		 

	
	
	
		public static void main(String[] args) {
			new JTabelTest();
		}
	}



// open , close 
package ch03;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;


public class DataB {
	public static Connection conn = null;
	public static void open() throws SQLException {
		try {	
			Class.forName("com.mysql.jdbc.Driver");
			conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/store?characterEncoding=UTF-8&serverTimezone=Asia/Seoul", "root", "2943");
			System.out.println("데이터베이스 연결이 성공했습니다.");
		}catch (ClassNotFoundException | SQLException e) {
			System.out.println("데이터베이스 연결이 실패했습니다.");
			System.out.println(e.getMessage());
			e.printStackTrace();
		}
	}
	
	

	public static void close() throws SQLException{
		conn.close();
	}
}

